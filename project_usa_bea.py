#-*- coding: utf-8 -*-
"""
Created on Thu Jan  9 21:17:48 2020

@author: Mastermind
"""


def data_сombined():
    """Most Up-To-Date Version"""
    """US BEA Fixed Assets Series Tests"""
    """Item 1.1"""
    # """Investment in Fixed Assets, Private, i3ptotl1es000, 1901--2016"""
    # file_name = 'dataset_usa_bea-sfat-release-2017-08-23-SectionAll_xls.zip'
    # fetch_usa_bea(file_name, 'Section1ALL_xls.xls', '105 Ann', 'i3ptotl1es000')
    """Item 1.2"""
    # """Chain-Type Quantity Index for Investment in Fixed Assets, Private, icptotl1es000, 1901--2016"""
    # file_name = 'dataset_usa_bea-sfat-release-2017-08-23-SectionAll_xls.zip'
    # fetch_usa_bea(file_name, 'Section1ALL_xls.xls', '106 Ann', 'icptotl1es000')
    """Item 1.3"""
    # """Current-Cost Net Stock of Fixed Assets, Private, k1ptotl1es000, 1925--2016"""
    # file_name = 'dataset_usa_bea-sfat-release-2017-08-23-SectionAll_xls.zip'
    # fetch_usa_bea(file_name, 'Section1ALL_xls.xls', '101 Ann', 'k1ptotl1es000')
    """Item 1.4: Don't Use"""
    # """Historical-Cost Net Stock of Private Fixed Assets, Private Fixed Assets, k3ptotl1es000, 1925--2016"""
    # file_name = 'dataset_usa_bea-sfat-release-2017-08-23-SectionAll_xls.zip'
    # fetch_usa_bea(file_name, 'Section2ALL_xls.xls', '203 Ann', 'k3ptotl1es000')
    """Item 1.5"""
    # """Chain-Type Quantity Indexes for Net Stock of Fixed Assets, Private, kcptotl1es000, 1925--2016"""
    # file_name = 'dataset_usa_bea-sfat-release-2017-08-23-SectionAll_xls.zip'
    # fetch_usa_bea(file_name, 'Section1ALL_xls.xls', '102 Ann', 'kcptotl1es000')
    """Item 2.1: Don't Use, Use Item 1.1 Instead"""
    # """Investment in Fixed Assets, Private, i3ptotl1es000, 1901--2016"""
    # file_name = 'dataset_usa_bea-sfat-release-2017-08-23-SectionAll_xls.zip'
    # fetch_usa_bea(file_name, 'Section1ALL_xls.xls', '105 Ann', 'i3ptotl1es000')
    """Item 2.2: Don't Use, Use Item 1.2 Instead"""
    # """Chain-Type Quantity Index for Investment in Fixed Assets, Private, icptotl1es000, 1901--2016"""
    # file_name = 'dataset_usa_bea-sfat-release-2017-08-23-SectionAll_xls.zip'
    # fetch_usa_bea(file_name, 'Section1ALL_xls.xls', '106 Ann', 'icptotl1es000')
    """Item 2.3: Don't Use, Use Item 1.3 Instead"""
    # """Current-Cost Net Stock of Fixed Assets, Private, k1ptotl1es000, 1925--2016"""
    # file_name = 'dataset_usa_bea-sfat-release-2017-08-23-SectionAll_xls.zip'
    # fetch_usa_bea(file_name, 'Section1ALL_xls.xls', '101 Ann', 'k1ptotl1es000')
    """Item 2.4"""
    # """Historical-Cost Net Stock of Private Fixed Assets, Private Fixed Assets, k3ptotl1es000, 1925--2016"""
    # file_name = 'dataset_usa_bea-sfat-release-2017-08-23-SectionAll_xls.zip'
    # fetch_usa_bea(file_name, 'Section2ALL_xls.xls', '203 Ann', 'k3ptotl1es000')
    """Item 2.5: Don't Use, Use Item 1.5 Instead"""
    # """Chain-Type Quantity Indexes for Net Stock of Fixed Assets, Private, kcptotl1es000, 1925--2016"""
    # file_name = 'dataset_usa_bea-sfat-release-2017-08-23-SectionAll_xls.zip'
    # fetch_usa_bea(file_name, 'Section1ALL_xls.xls', '102 Ann', 'kcptotl1es000')
    """Item 3.1: Don't Use, Use Item 1.1 Instead"""
    # """Investment in Fixed Assets, Private, i3ptotl1es000, 1901--2016"""
    # file_name = 'dataset_usa_bea-sfat-release-2017-08-23-SectionAll_xls.zip'
    # fetch_usa_bea(file_name, 'Section1ALL_xls.xls', '105 Ann', 'i3ptotl1es000')
    """Item 3.2: Don't Use, Use Item 1.2 Instead"""
    # """Chain-Type Quantity Index for Investment in Fixed Assets, Private, icptotl1es000, 1901--2016"""
    # file_name = 'dataset_usa_bea-sfat-release-2017-08-23-SectionAll_xls.zip'
    # fetch_usa_bea(file_name, 'Section1ALL_xls.xls', '106 Ann', 'icptotl1es000')
    """Item 3.3: Don't Use, Use Item 1.3 Instead"""
    # """Current-Cost Net Stock of Fixed Assets, Private, k1ptotl1es000, 1925--2016"""
    # file_name = 'dataset_usa_bea-sfat-release-2017-08-23-SectionAll_xls.zip'
    # fetch_usa_bea(file_name, 'Section1ALL_xls.xls', '101 Ann', 'k1ptotl1es000')
    """Item 3.4: Don't Use, Use Item 2.4 Instead"""
    # """Historical-Cost Net Stock of Private Fixed Assets, Private Fixed Assets, k3ptotl1es000, 1925--2016"""
    # file_name = 'dataset_usa_bea-sfat-release-2017-08-23-SectionAll_xls.zip'
    # fetch_usa_bea(file_name, 'Section2ALL_xls.xls', '203 Ann', 'k3ptotl1es000')
    """Item 3.5: Don't Use, Use Item 1.5 Instead"""
    # """Chain-Type Quantity Indexes for Net Stock of Fixed Assets, Private, kcptotl1es000, 1925--2016"""
    # file_name = 'dataset_usa_bea-sfat-release-2017-08-23-SectionAll_xls.zip'
    # fetch_usa_bea(file_name, 'Section1ALL_xls.xls', '102 Ann', 'kcptotl1es000')
    """Item 4.1: Don't Use"""
    # """Investment in Fixed Assets, Private, i3ptotl1es000, 1901--2016"""
    # file_name = 'dataset_usa_bea-sfat-release-2017-08-23-SectionAll_xls.zip'
    # fetch_usa_bea(file_name, 'Section1ALL_xls.xls', '105 Ann', 'i3ptotl1es000')
    """Item 4.2: Don't Use"""
    # """Chain-Type Quantity Index for Investment in Fixed Assets, Private, icptotl1es000, 1901--2016"""
    # file_name = 'dataset_usa_bea-sfat-release-2017-08-23-SectionAll_xls.zip'
    # fetch_usa_bea(file_name, 'Section1ALL_xls.xls', '106 Ann', 'icptotl1es000')
    """Item 4.3: Don't Use"""
    # """Current-Cost Net Stock of Fixed Assets, Private, k1ptotl1es000, 1925--2016"""
    # file_name = 'dataset_usa_bea-sfat-release-2017-08-23-SectionAll_xls.zip'
    # fetch_usa_bea(file_name, 'Section1ALL_xls.xls', '101 Ann', 'k1ptotl1es000')
    """Item 4.4: Don't Use"""
    # """Historical-Cost Net Stock of Private Fixed Assets, Private Fixed Assets, k3ptotl1es000, 1925--2016"""
    # file_name = 'dataset_usa_bea-sfat-release-2017-08-23-SectionAll_xls.zip'
    # fetch_usa_bea(file_name, 'Section2ALL_xls.xls', '203 Ann', 'k3ptotl1es000')
    """Item 4.5: Don't Use"""
    # """Chain-Type Quantity Indexes for Net Stock of Fixed Assets, Private, kcptotl1es000, 1925--2016"""
    # file_name = 'dataset_usa_bea-sfat-release-2017-08-23-SectionAll_xls.zip'
    # fetch_usa_bea(file_name, 'Section1ALL_xls.xls', '102 Ann', 'kcptotl1es000')
    """Item 5.1: Don't Use"""
    # """Investment in Fixed Assets, Private, i3ptotl1es000, 1901--2016"""
    # file_name = 'dataset_usa_bea-sfat-release-2017-08-23-SectionAll_xls.zip'
    # fetch_usa_bea(file_name, 'Section1ALL_xls.xls', '105 Ann', 'i3ptotl1es000')
    """Item 5.2: Don't Use"""
    # """Chain-Type Quantity Index for Investment in Fixed Assets, Private, icptotl1es000, 1901--2016"""
    # file_name = 'dataset_usa_bea-sfat-release-2017-08-23-SectionAll_xls.zip'
    # fetch_usa_bea(file_name, 'Section1ALL_xls.xls', '106 Ann', 'icptotl1es000')
    """Item 5.3: Don't Use"""
    # """Current-Cost Net Stock of Fixed Assets, Private, k1ptotl1es000, 1925--2016"""
    # file_name = 'dataset_usa_bea-sfat-release-2017-08-23-SectionAll_xls.zip'
    # fetch_usa_bea(file_name, 'Section1ALL_xls.xls', '101 Ann', 'k1ptotl1es000')
    """Item 5.4: Don't Use"""
    # """Historical-Cost Net Stock of Private Fixed Assets, Private Fixed Assets, k3ptotl1es000, 1925--2016"""
    # file_name = 'dataset_usa_bea-sfat-release-2017-08-23-SectionAll_xls.zip'
    # fetch_usa_bea(file_name, 'Section2ALL_xls.xls', '203 Ann', 'k3ptotl1es000')
    """Item 5.5: Don't Use"""
    # """Chain-Type Quantity Indexes for Net Stock of Fixed Assets, Private, kcptotl1es000, 1925--2016"""
    # file_name = 'dataset_usa_bea-sfat-release-2017-08-23-SectionAll_xls.zip'
    # fetch_usa_bea(file_name, 'Section1ALL_xls.xls', '102 Ann', 'kcptotl1es000')
    """Item 6.1: Don't Use, Use Item 1.1 Instead"""
    # """Investment in Fixed Assets, Private, i3ptotl1es000, 1901--2016"""
    # file_name = 'dataset_usa_bea-sfat-release-2017-08-23-SectionAll_xls.zip'
    # fetch_usa_bea(file_name, 'Section1ALL_xls.xls', '105 Ann', 'i3ptotl1es000')
    """Item 6.2: Don't Use, Use Item 1.2 Instead"""
    # """Chain-Type Quantity Index for Investment in Fixed Assets, Private, icptotl1es000, 1901--2016"""
    # file_name = 'dataset_usa_bea-sfat-release-2017-08-23-SectionAll_xls.zip'
    # fetch_usa_bea(file_name, 'Section1ALL_xls.xls', '106 Ann', 'icptotl1es000')
    """Item 6.3: Don't Use, Use Item 1.3 Instead"""
    # """Current-Cost Net Stock of Fixed Assets, Private, k1ptotl1es000, 1925--2016"""
    # file_name = 'dataset_usa_bea-sfat-release-2017-08-23-SectionAll_xls.zip'
    # fetch_usa_bea(file_name, 'Section1ALL_xls.xls', '101 Ann', 'k1ptotl1es000')
    """Item 6.4: Don't Use, Use Item 2.4 Instead"""
    # """Historical-Cost Net Stock of Private Fixed Assets, Private Fixed Assets, k3ptotl1es000, 1925--2016"""
    # file_name = 'dataset_usa_bea-sfat-release-2017-08-23-SectionAll_xls.zip'
    # fetch_usa_bea(file_name, 'Section2ALL_xls.xls', '203 Ann', 'k3ptotl1es000')
    """Item 6.5: Don't Use, Use Item 1.5 Instead"""
    # """Chain-Type Quantity Indexes for Net Stock of Fixed Assets, Private, kcptotl1es000, 1925--2016"""
    # file_name = 'dataset_usa_bea-sfat-release-2017-08-23-SectionAll_xls.zip'
    # fetch_usa_bea(file_name, 'Section1ALL_xls.xls', '102 Ann', 'kcptotl1es000')
    """Item 7.1: Don't Use"""
    # """Investment in Fixed Assets, Private, i3ptotl1es000, 1901--2016"""
    # file_name = 'dataset_usa_bea-sfat-release-2017-08-23-SectionAll_xls.zip'
    # fetch_usa_bea(file_name, 'Section1ALL_xls.xls', '105 Ann', 'i3ptotl1es000')
    """Item 7.2: Don't Use"""
    # """Chain-Type Quantity Index for Investment in Fixed Assets, Private, icptotl1es000, 1901--2016"""
    # file_name = 'dataset_usa_bea-sfat-release-2017-08-23-SectionAll_xls.zip'
    # fetch_usa_bea(file_name, 'Section1ALL_xls.xls', '106 Ann', 'icptotl1es000')
    """Item 7.3: Don't Use"""
    # """Current-Cost Net Stock of Fixed Assets, Private, k1ptotl1es000, 1925--2016"""
    # file_name = 'dataset_usa_bea-sfat-release-2017-08-23-SectionAll_xls.zip'
    # fetch_usa_bea(file_name, 'Section1ALL_xls.xls', '101 Ann', 'k1ptotl1es000')
    """Item 7.4: Don't Use"""
    # """Historical-Cost Net Stock of Private Fixed Assets, Private Fixed Assets, k3ptotl1es000, 1925--2016"""
    # file_name = 'dataset_usa_bea-sfat-release-2017-08-23-SectionAll_xls.zip'
    # fetch_usa_bea(file_name, 'Section2ALL_xls.xls', '203 Ann', 'k3ptotl1es000')
    """Item 7.5: Don't Use"""
    # """Chain-Type Quantity Indexes for Net Stock of Fixed Assets, Private, kcptotl1es000, 1925--2016"""
    # file_name = 'dataset_usa_bea-sfat-release-2017-08-23-SectionAll_xls.zip'
    # fetch_usa_bea(file_name, 'Section1ALL_xls.xls', '102 Ann', 'kcptotl1es000')
    """Item 8.1: Don't Use"""
    # """Investment in Fixed Assets, Private, i3ptotl1es000, 1901--2016"""
    # file_name = 'dataset_usa_bea-sfat-release-2017-08-23-SectionAll_xls.zip'
    # fetch_usa_bea(file_name, 'Section1ALL_xls.xls', '105 Ann', 'i3ptotl1es000')
    """Item 8.2: Don't Use"""
    # """Chain-Type Quantity Index for Investment in Fixed Assets, Private, icptotl1es000, 1901--2016"""
    # file_name = 'dataset_usa_bea-sfat-release-2017-08-23-SectionAll_xls.zip'
    # fetch_usa_bea(file_name, 'Section1ALL_xls.xls', '106 Ann', 'icptotl1es000')
    """Item 8.3: Don't Use"""
    # """Current-Cost Net Stock of Fixed Assets, Private, k1ptotl1es000, 1925--2016"""
    # file_name = 'dataset_usa_bea-sfat-release-2017-08-23-SectionAll_xls.zip'
    # fetch_usa_bea(file_name, 'Section1ALL_xls.xls', '101 Ann', 'k1ptotl1es000')
    """Item 8.4: Don't Use"""
    # """Historical-Cost Net Stock of Private Fixed Assets, Private Fixed Assets, k3ptotl1es000, 1925--2016"""
    # file_name = 'dataset_usa_bea-sfat-release-2017-08-23-SectionAll_xls.zip'
    # fetch_usa_bea(file_name, 'Section2ALL_xls.xls', '203 Ann', 'k3ptotl1es000')
    """Item 8.5: Don't Use"""
    # """Chain-Type Quantity Indexes for Net Stock of Fixed Assets, Private, kcptotl1es000, 1925--2016"""
    # file_name = 'dataset_usa_bea-sfat-release-2017-08-23-SectionAll_xls.zip'
    # fetch_usa_bea(file_name, 'Section1ALL_xls.xls', '102 Ann', 'kcptotl1es000')
    """Item 9.1: Don't Use"""
    # """Investment in Fixed Assets, Private, i3ptotl1es000, 1901--2016"""
    # file_name = 'dataset_usa_bea-sfat-release-2017-08-23-SectionAll_xls.zip'
    # fetch_usa_bea(file_name, 'Section1ALL_xls.xls', '105 Ann', 'i3ptotl1es000')
    """Item 9.2: Don't Use"""
    # """Chain-Type Quantity Index for Investment in Fixed Assets, Private, icptotl1es000, 1901--2016"""
    # file_name = 'dataset_usa_bea-sfat-release-2017-08-23-SectionAll_xls.zip'
    # fetch_usa_bea(file_name, 'Section1ALL_xls.xls', '106 Ann', 'icptotl1es000')
    """Item 9.3: Don't Use"""
    # """Current-Cost Net Stock of Fixed Assets, Private, k1ptotl1es000, 1925--2016"""
    # file_name = 'dataset_usa_bea-sfat-release-2017-08-23-SectionAll_xls.zip'
    # fetch_usa_bea(file_name, 'Section1ALL_xls.xls', '101 Ann', 'k1ptotl1es000')
    """Item 9.4: Don't Use"""
    # """Historical-Cost Net Stock of Private Fixed Assets, Private Fixed Assets, k3ptotl1es000, 1925--2016"""
    # file_name = 'dataset_usa_bea-sfat-release-2017-08-23-SectionAll_xls.zip'
    # fetch_usa_bea(file_name, 'Section2ALL_xls.xls', '203 Ann', 'k3ptotl1es000')
    """Item 9.5: Don't Use"""
    # """Chain-Type Quantity Indexes for Net Stock of Fixed Assets, Private, kcptotl1es000, 1925--2016"""
    # file_name = 'dataset_usa_bea-sfat-release-2017-08-23-SectionAll_xls.zip'
    # fetch_usa_bea(file_name, 'Section1ALL_xls.xls', '102 Ann', 'kcptotl1es000')

    semi_frame_a = fetch_bea_usa('dataset_usa_bea_nipadataa.txt', 'A006RC')
    semi_frame_b = fetch_bea_usa('dataset_usa_bea_nipadataa.txt', 'A006RD')
    semi_frame_c = fetch_bea_usa('dataset_usa_bea_nipadataa.txt', 'A008RC')
    semi_frame_d = fetch_bea_usa('dataset_usa_bea_nipadataa.txt', 'A008RD')
    semi_frame_e = fetch_bea_usa('dataset_usa_bea_nipadataa.txt', 'A032RC')
    semi_frame_f = fetch_bea_usa('dataset_usa_bea_nipadataa.txt', 'A191RA')
    semi_frame_g = fetch_bea_usa('dataset_usa_bea_nipadataa.txt', 'A191RC')
    semi_frame_h = fetch_bea_usa('dataset_usa_bea_nipadataa.txt', 'A191RX')
    sub_frame_a = fetch_bea_usa('dataset_usa_bea_nipadataa.txt', 'H4313C')
    sub_frame_b = fetch_bea_usa('dataset_usa_bea_nipadataa.txt', 'J4313C')
    sub_frame_c = fetch_bea_usa('dataset_usa_bea_nipadataa.txt', 'A4313C')
    sub_frame_d = fetch_bea_usa('dataset_usa_bea_nipadataa.txt', 'N4313C')
    semi_frame_i = pd.concat([sub_frame_a, sub_frame_b, sub_frame_c, sub_frame_d], axis=1, sort=True)

    semi_frame_i = semi_frame_i.mean(1)
    semi_frame_i = semi_frame_i.to_frame(name='Labor')
    semi_frame_j = fetch_bea_usa('dataset_usa_bea_nipadataa.txt', 'W170RC')
    semi_frame_k = fetch_bea_usa('dataset_usa_bea_nipadataa.txt', 'W170RX')
    """Fixed Assets Series: K100701, 1951--1969"""
    file_name = 'dataset_usa_bea-release-2015-03-02 Section5ALL_Hist.xls'
    sub_frame_a = fetch_usa_bea(None, file_name, '51000 Ann', 'K100701')
    """Fixed Assets Series: K100701, 1969--2013"""
    file_name = 'dataset_usa_bea-release-2015-03-02 Section5all_xls.xls'
    sub_frame_b = fetch_usa_bea(None, file_name, '51000 Ann', 'K100701')
    semi_frame_l = sub_frame_a.append(sub_frame_b).drop_duplicates()

    """Investment in Fixed Assets, Private, i3ptotl1es000, 1901--2016"""
    file_name = 'dataset_usa_bea-sfat-release-2017-08-23-SectionAll_xls.zip'
    semi_frame_m = fetch_usa_bea(file_name, 'Section1ALL_xls.xls', '105 Ann', 'i3ptotl1es000')
    """Chain-Type Quantity Index for Investment in Fixed Assets, Private, icptotl1es000, 1901--2016"""
    file_name = 'dataset_usa_bea-sfat-release-2017-08-23-SectionAll_xls.zip'
    semi_frame_n = fetch_usa_bea(file_name, 'Section1ALL_xls.xls', '106 Ann', 'icptotl1es000')
    """Current-Cost Net Stock of Fixed Assets, Private, k1ptotl1es000, 1925--2016"""
    file_name = 'dataset_usa_bea-sfat-release-2017-08-23-SectionAll_xls.zip'
    semi_frame_o = fetch_usa_bea(file_name, 'Section1ALL_xls.xls', '101 Ann', 'k1ptotl1es000')
    """Historical-Cost Net Stock of Private Fixed Assets, Private Fixed Assets, k3ptotl1es000, 1925--2016"""
    file_name = 'dataset_usa_bea-sfat-release-2017-08-23-SectionAll_xls.zip'
    semi_frame_p = fetch_usa_bea(file_name, 'Section2ALL_xls.xls', '203 Ann', 'k3ptotl1es000')
    """Chain-Type Quantity Indexes for Net Stock of Fixed Assets, Private, kcptotl1es000, 1925--2016"""
    file_name = 'dataset_usa_bea-sfat-release-2017-08-23-SectionAll_xls.zip'
    semi_frame_q = fetch_usa_bea(file_name, 'Section1ALL_xls.xls', '102 Ann', 'kcptotl1es000')
    semi_frame_r = fetch_usa_frb_ms()
    semi_frame_s = fetch_usa_frb_ms()
    semi_frame_t = fetch_usa_frb_ms()
    file_name = 'dataset_usa_0025_p_r.txt'
    semi_frame_u = pd.read_csv(file_name)
    semi_frame_u.columns = semi_frame_u.columns.str.title()
    semi_frame_u = semi_frame_u.set_index('Period')
    result_frame = pd.concat([semi_frame_a, semi_frame_b, semi_frame_c, semi_frame_d, semi_frame_e, \
                           semi_frame_f, semi_frame_g, semi_frame_h, semi_frame_i, semi_frame_j, \
                           semi_frame_k, semi_frame_l, semi_frame_m, semi_frame_n, semi_frame_o, \
                           semi_frame_p, semi_frame_q, semi_frame_r, semi_frame_s, semi_frame_t, \
                           semi_frame_u], axis=1, sort=True)
    return result_frame


def preprocessing_a(source_frame):
    source_frame = source_frame[source_frame.columns[[0, 4, 6, 7]]]
    source_frame = source_frame.dropna()
    source_frame = source_frame.div(source_frame.iloc[0, :])
    source_frame.reset_index(level=0, inplace=True)
    return source_frame


def preprocessing_b(source_frame):
    source_frame = source_frame[source_frame.columns[[0, 6, 7, 20]]]
    source_frame = source_frame.dropna()
    source_frame.reset_index(level=0, inplace=True)
    return source_frame


def preprocessing_c(source_frame):
    source_frame_production = source_frame[source_frame.columns[[0, 6, 7]]]
    source_frame_production = source_frame_production.dropna()
    source_frame_production = source_frame_production.div(source_frame_production.iloc[0, :])
    source_frame_money = source_frame.iloc[:, 18:20]
    source_frame_money = source_frame_money.mean(1)
    source_frame_money = pd.DataFrame(source_frame_money, columns=['M1']) # # Convert Series to Dataframe
    source_frame_money = source_frame_money.dropna()
    source_frame_money = source_frame_money.div(source_frame_money.iloc[0, :])
    result_frame = pd.concat([source_frame_production, source_frame_money], axis=1)
    result_frame = result_frame.dropna()
    result_frame = result_frame.div(result_frame.iloc[0, :])
    result_frame.reset_index(level=0, inplace=True)
    return result_frame


def preprocessing_d(source_frame):
    source_frame = source_frame[source_frame.columns[[0, 1, 2, 3, 7]]]
    source_frame = source_frame.dropna()
    source_frame.reset_index(level=0, inplace=True)
    return source_frame


def preprocessing_e(source_frame):
    """Works on Result of `data_сombined_archived`"""
    """`Real` Investment"""
    source_frame['inv'] = source_frame.iloc[:, 0]*source_frame.iloc[:, 7].div(source_frame.iloc[:, 6])
    """`Real` Capital"""
    source_frame['cap'] = source_frame.iloc[:, 11]*source_frame.iloc[:, 7].div(source_frame.iloc[:, 6])
    """Nominal DataSet"""
    nominal_frame = source_frame[source_frame.columns[[0, 6, 11]]].dropna()
    """`Real` DataSet"""
    real_frame = source_frame[source_frame.columns[[21, 7, 22]]].dropna()
    return nominal_frame, real_frame


source_frame_a = data_сombined_archived()
source_frame_b = data_сombined()
"""Project: Initial Version Dated: 05 October 2012"""
result_frame_ab = preprocessing_a(source_frame_a)
result_frame_ac = preprocessing_a(source_frame_b)
data_fetch_plot_a(result_frame_ab)
data_fetch_plot_a(result_frame_ac)
"""Project: Initial Version Dated: 23 November 2012"""
result_frame_bb = preprocessing_b(source_frame_a)
result_frame_bc = preprocessing_b(source_frame_b)
data_fetch_plot_b(result_frame_bb)
data_fetch_plot_b(result_frame_bc)
"""Project: Initial Version Dated: 16 June 2013"""
result_frame_cb = preprocessing_c(source_frame_a)
result_frame_cc = preprocessing_c(source_frame_b)
data_fetch_plot_c(result_frame_cb)
data_fetch_plot_c(result_frame_cc)
"""Project: Initial Version Dated: 15 June 2015"""
result_frame_d = preprocessing_d(source_frame_b)
data_fetch_plot_d(result_frame_d)
"""Project: Initial Version Dated: 17 February 2013"""
result_frame_ea, result_frame_eb = preprocessing_e(source_frame_a)
plot_e(result_frame_ea)
plot_e(result_frame_eb)
"""Project: BEA Data Compared with Kurenkov Yu.V. Data"""
result_frame_fa, result_frame_fb, result_frame_fc, result_frame_fd = preprocessing_f(source_frame_a)
plot_f(result_frame_fa, result_frame_fb, result_frame_fc, result_frame_fd)